
ETL Staging Layer Solution
17
<p>1. In Control flow add Squence container for staging layer.</p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1579/17/1.jpg" style="width: 50%;"></p><p><br></p><p>2. Create a new connection to Stroke_Mortality_Staging</p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1579/17/2.jpg" style="width: 50%;"></p><p><br></p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1579/17/3.jpg" style="width: 50%;"></p><p><br></p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1579/17/4.jpg" style="width: 50%;"></p><p><br></p><p>3. Add tasks to Scquence container</p><ul><li>Add Execute SQL Task (Truncate Staging table)</li><li>Data Flow task (Load staging table)</li></ul><p>ETL Staging Solution resemble the below image</p><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1579/17/5.jpg"></p><p><br></p><p>4. Inside Execute SQL Task</p><ul><li>Copy and paste&nbsp;TRUNCATE TABLE [dbo].[tbl_stg_StrokeMortality1] into the SQLStatement section</li></ul><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1579/17/6.jpg" style="width: 50%;"></p><p><br></p><p>5. Inside Data Flow task</p><ul><li>Add Script Componenet (Json Exraction)</li><li>Add OLEDB Destination&nbsp;</li><li>Connect them all as shown in the below image</li></ul><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1579/17/7.jpg" style="width: 50%;"><br></p><p><br></p><p>6. Configure Script Component</p><ul><li>Use script component as source</li></ul><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1579/17/8.jpg" style="width: 50%;"></p><p><br></p><ul><li>Configure the inout and output columns with Datatypes</li></ul><p><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1579/17/9.jpg" style="width: 50%;">&nbsp; </p><p><br></p><p>&nbsp;&nbsp;<img src="https://app.colaberry.com/uploads/ProjectStepsImages/1579/17/10.jpg" style="width: 50%;"></p><p><br></p><ul><li>In Edit script, Add Reference -&nbsp;<span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">system.web.extension,&nbsp;<span style="font-weight: normal; font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">in order
tor ead JSON files</span><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><font face="Times New Roman, serif"><b>.</b></font></span></span></li></ul><p><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><font face="Times New Roman, serif"><b><br></b></font></span></span></p><p>&nbsp; &nbsp;<img src="https://app.colaberry.com/uploads/ProjectStepsImages/1579/17/11.jpg" style="width: 50%;">&nbsp; </p><p><br></p><p>&nbsp;&nbsp;<img src="https://app.colaberry.com/uploads/ProjectStepsImages/1579/17/12.jpg" style="width: 50%;"><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><font face="Times New Roman, serif"><b><br></b></font></span></span></p><p><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><font face="Times New Roman, serif"><b><br></b></font></span></span></p><p>&nbsp; &nbsp;<img src="https://app.colaberry.com/uploads/ProjectStepsImages/1579/17/13.jpg" style="width: 50%;"><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><font face="Times New Roman, serif"><b><br></b></font></span></span></p><p><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><font face="Times New Roman, serif"><b><br></b></font></span></span></p><p><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"></span></span></p><ul><li><p class="MsoNormal"><strong><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-weight: normal;">Add Class
inside the Script Editor</span></strong><b><span style="font-size: 12pt; line-height: 107%; font-family: &quot;Times New Roman&quot;, serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"> </span></b><span style="font-size: 12pt; line-height: 107%; font-family: &quot;Times New Roman&quot;, serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">and<b> </b>s<strong><span style="font-weight:normal">ave
the class as 'StrokeMortalityClass.cs'.</span></strong></span></p><p class="MsoNormal"><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1579/17/14.jpg" style="width: 50%;">&nbsp;&nbsp;</p><p class="MsoNormal"><br></p><p class="MsoNormal"><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1579/17/15.jpg" style="width: 50%;"></p><p class="MsoNormal"><br></p></li></ul><p></p><ul></ul><p></p><p><br></p><ul><li><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><font face="Times New Roman, serif"><b><p class="MsoNormal"><strong><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-weight: normal;">Add this
Code to Class&nbsp;<span style="scrollbar-color: rgb(193, 193, 193) rgba(0, 0, 0, 0); scrollbar-width: thin;">StrokeMortalityClass.cs and Save</span></span></strong></p><p class="MsoNormal"><strong><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-weight: normal;"><span style="scrollbar-color: rgb(193, 193, 193) rgba(0, 0, 0, 0); scrollbar-width: thin;"><o:p><br></o:p></span></span></strong></p><p class="MsoNormal"><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1579/17/16.jpg" style="width: 50%;"><strong style="font-size: 12pt;"><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-weight: normal;"><span style="scrollbar-color: rgb(193, 193, 193) rgba(0, 0, 0, 0); scrollbar-width: thin;"><o:p><strong><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-weight: normal;"><br></span></strong></o:p></span></span></strong></p><p class="MsoNormal"><strong style="font-size: 12pt;"><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-weight: normal;"><span style="scrollbar-color: rgb(193, 193, 193) rgba(0, 0, 0, 0); scrollbar-width: thin;"><o:p><strong><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-weight: normal;"><br></span></strong></o:p></span></span></strong></p></b></font></span></span></li></ul><p><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><font face="Times New Roman, serif"><b></b></font></span></span></p><ul></ul><p></p><ul><li><strong style="font-size: 12pt;"><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-weight: normal;"><span style="scrollbar-color: rgb(193, 193, 193) rgba(0, 0, 0, 0); scrollbar-width: thin;"><o:p><strong><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-weight: normal;">Configuring
the ‘Main Class’ script editor,&nbsp;</span></strong><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><strong style="scrollbar-color: rgb(193, 193, 193) rgba(0, 0, 0, 0); scrollbar-width: thin;"><span style="font-weight:normal">Add this Code in the
namespace.</span></strong></span></o:p></span></span></strong></li></ul><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<img src="https://app.colaberry.com/uploads/ProjectStepsImages/1579/17/17.jpg" style="width: 50%;"><strong style="font-size: 12pt;"><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-weight: normal;"><span style="scrollbar-color: rgb(193, 193, 193) rgba(0, 0, 0, 0); scrollbar-width: thin;"><o:p><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><strong style="scrollbar-color: rgb(193, 193, 193) rgba(0, 0, 0, 0); scrollbar-width: thin;"><span style="font-weight:normal"><br></span></strong></span></o:p></span></span></strong></p><p><strong style="font-size: 12pt;"><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-weight: normal;"><span style="scrollbar-color: rgb(193, 193, 193) rgba(0, 0, 0, 0); scrollbar-width: thin;"><o:p><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><strong style="scrollbar-color: rgb(193, 193, 193) rgba(0, 0, 0, 0); scrollbar-width: thin;"><span style="font-weight:normal"><br></span></strong></span></o:p></span></span></strong></p><ul><li><strong style="font-size: 12pt;"><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-weight: normal;"><span style="scrollbar-color: rgb(193, 193, 193) rgba(0, 0, 0, 0); scrollbar-width: thin;"><o:p><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><strong style="scrollbar-color: rgb(193, 193, 193) rgba(0, 0, 0, 0); scrollbar-width: thin;"><span style="font-weight:normal">Add this
Code to Serialize the JSON File. Then Save, build, run and close the script.</span></strong></span></o:p></span></span></strong></li></ul><p><strong style="font-size: 12pt;"><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-weight: normal;"><span style="scrollbar-color: rgb(193, 193, 193) rgba(0, 0, 0, 0); scrollbar-width: thin;"><o:p><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><strong style="scrollbar-color: rgb(193, 193, 193) rgba(0, 0, 0, 0); scrollbar-width: thin;"><span style="font-weight:normal">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></strong></span></o:p></span></span></strong><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1579/17/18.jpg" style="width: 50%;"></p><p><strong style="scrollbar-color: rgb(193, 193, 193) rgba(0, 0, 0, 0); scrollbar-width: thin;"><span style="font-weight:normal"><br></span></strong></p><p><strong style="scrollbar-color: rgb(193, 193, 193) rgba(0, 0, 0, 0); scrollbar-width: thin;"><span style="font-weight:normal">7. Inside OLEDB Destination
'tbl_Stg_StrokeMortality1'</span></strong></p><p><strong style="scrollbar-color: rgb(193, 193, 193) rgba(0, 0, 0, 0); scrollbar-width: thin;"><span style="font-weight:normal"><br></span></strong></p><p>&nbsp; &nbsp; &nbsp;&nbsp;<img src="https://app.colaberry.com/uploads/ProjectStepsImages/1579/17/19.jpg" style="width: 50%;"><strong style="scrollbar-color: rgb(193, 193, 193) rgba(0, 0, 0, 0); scrollbar-width: thin;"><span style="font-weight:normal"><br></span></strong></p><p><br></p><ul><li><strong style="font-size: 12pt;"><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-weight: normal;"><span style="scrollbar-color: rgb(193, 193, 193) rgba(0, 0, 0, 0); scrollbar-width: thin;"><o:p><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><strong style="scrollbar-color: rgb(193, 193, 193) rgba(0, 0, 0, 0); scrollbar-width: thin;"><span style="font-weight:normal"><strong style="font-size: 14px;"><span style="font-size: 12pt; line-height: 17.12px; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-weight: normal;">Map the columns</span></strong></span></strong></span></o:p></span></span></strong></li></ul><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<img src="https://app.colaberry.com/uploads/ProjectStepsImages/1579/17/20.jpg" style="width: 50%;"></p><p><br></p><ul><li style="margin-bottom: 0in; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 12pt; font-family: &quot;Times New Roman&quot;, serif;">Executed ETL Package for
Staging Layer to load data</span>.</li></ul><p style="margin-bottom: 0in; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 12pt; font-family: &quot;Times New Roman&quot;, serif;"><br></span></p><p style="margin-bottom: 0in; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 12pt; font-family: &quot;Times New Roman&quot;, serif;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1579/17/21.jpg" style="width: 50%;">&nbsp;</p><p style="margin-bottom: 0in; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><br></p><p style="margin-bottom: 0in; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><br></p><p style="margin-bottom: 0in; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;<img src="https://app.colaberry.com/uploads/ProjectStepsImages/1579/17/22.jpg" style="width: 50%;"></p><p style="margin-bottom: 0in; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><br></p><p style="margin-bottom: 0in; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><br></p><ul><li style="margin-bottom: 0in; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><strong><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-weight: normal;">Data in
the Staging Table 'tbl_Stg_StrokeMortality1' in SQL.</span></strong></li></ul><p style="margin-bottom: 0in; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><strong><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-weight: normal;"><br></span></strong></p><p style="margin-bottom: 0in; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><strong><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-weight: normal;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></strong><img src="https://app.colaberry.com/uploads/ProjectStepsImages/1579/17/23.jpg" style="width: 50%;"><strong><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-weight: normal;"><br></span></strong><br></p><p style="margin-bottom: 0in; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><br></p><p style="margin-bottom: 0in; line-height: normal; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><br></p><p><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-size: 12pt; line-height: 107%; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><font face="Times New Roman, serif"><b><br></b></font></span></span></p>

<div><a href="https://learn.microsoft.com/en-us/sql/integration-services/connection-manager/integration-services-ssis-connections?view=sql-server-ver16" target="_blank">SSIS Connection Manager</a><br></div><div><a href="https://www.youtube.com/watch?v=vvx219hQjFY" target="_blank">Managing environment connections in SSIS</a></div><div><a href="https://learn.microsoft.com/en-us/sql/integration-services/data-flow/transformations/script-component?view=sql-server-ver16" target="_blank">Script Component</a></div><div><a href="https://www.youtube.com/watch?v=NuTphcfS3bc" target="_blank">Script components in SSIS</a></div><div><br></div>

